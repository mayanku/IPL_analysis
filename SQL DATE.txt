1)select DATE_PART('year',occurred_at) as ord_year,
  SUM(total_amt_usd) total_oreders from orders
  GROUP BY 1
  ORDER BY 2 DESC

2)SELECT DATE_PART('month', occurred_at) ord_month, SUM(total_amt_usd) total_spent
FROM orders
WHERE occurred_at BETWEEN '2014-01-01' AND '2017-01-01'
GROUP BY 1
ORDER BY 2 DESC; 

3)SELECT DATE_PART('year', occurred_at) ord_year,  COUNT(*) total_sales
FROM orders
GROUP BY 1
ORDER BY 2 DESC;

CASE
1)select account_id,total_amt_usd,
CASE WHEN total_amt_usd>3000 THEN 'LARGE'
ELSE 'SMALL' END AS order_level from orders

2)select CASE WHEN total>2000 THEN'ATLEAST 2000'
WHEN total <2000 AND total>1000 THEN' BETWEEN 2000 AND 1000' 
ELSE 'LESS THAT 1000' 
END AS order_category , COUNT(*) num_oreders from orders
group by 1

